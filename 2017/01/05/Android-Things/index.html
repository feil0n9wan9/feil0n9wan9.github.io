<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Android Things | 静静的扯淡</title>

  
  <meta name="author" content="Feilong Wang">
  

  
  <meta name="description" content="Google于12月13日对外发布了其新一代物联网操作系统Android Things，它的愿景是为各种消费、零售和工业应用程序提供互连的设备，并提供完整立即可用的硬件解决方案，以进一步实现If you can build an app, you can build a device。">
  

  
  
  <meta name="keywords" content="Android,Things,IoT,Brillo">
  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <meta property="og:title" content="Android Things"/>

  <meta property="og:site_name" content="静静的扯淡"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="静静的扯淡" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
</head>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/">静静的扯淡</a>
    </h1>
    <p class="site-description"></p>
  </div>
  <nav class="site-navigation">
    <ul>
      
        <li><a href="/">HOME</a></li>
      
        <li><a href="/archives/">ARCHIVES</a></li>
      
        <li><a href="https://www.jianshu.com/u/5215dba27120">JIANSHU</a></li>
      
        <li><a href="https://github.com/feil0n9wan9">GITHUB</a></li>
      
        <li><a href="/about/">ABOUT</a></li>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    <article>

  
    
    <h3 class="article-title"><span>Android Things</span></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2017/01/05/Android-Things/" rel="bookmark">
        <time class="entry-date published" datetime="2017-01-05T13:52:48.000Z">
          2017-01-05
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p><a href="https://www.google.com.hk/" target="_blank" rel="noopener">Google</a>于12月13日对外发布了其新一代物联网操作系统<a href="https://developer.android.com/things/index.html" target="_blank" rel="noopener">Android Things</a>，它的愿景是为各种消费、零售和工业应用程序提供互连的设备，并提供完整立即可用的硬件解决方案，以进一步实现<a href="https://developer.android.com/things/index.html" target="_blank" rel="noopener">If you can build an app, you can build a device</a>。<br><a id="more"></a></p>
<p><a href="https://developer.android.com/things/index.html" target="_blank" rel="noopener">Android Things</a>的前身是<a href="https://www.google.com.hk/" target="_blank" rel="noopener">Google</a>在其<a href="https://baike.baidu.com/item/Google%20I%2FO?fr=aladdin" target="_blank" rel="noopener">2015年I/O全球开发者大会</a>上推出的基于<a href="https://www.android.com" target="_blank" rel="noopener">Android</a>的物联网项目<a href="https://android.googlesource.com/brillo/manifest/" target="_blank" rel="noopener">Brillo</a>。然而经过一年多的发展，由于使用C/C++基于NDK进行开发，并且缺乏相应的开发工具，<a href="https://android.googlesource.com/brillo/manifest/" target="_blank" rel="noopener">Brillo</a>项目未能吸引足够的开发人员加入。<a href="https://developer.android.com/things/index.html" target="_blank" rel="noopener">Android Things</a>吸取了<a href="https://android.googlesource.com/brillo/manifest/" target="_blank" rel="noopener">Brillo</a>项目的反馈，通过Java API面向广大的Android和Java开发者，并加入了熟悉的工具，如<a href="https://developer.android.com/studio/index.html" target="_blank" rel="noopener">Android Studio</a>，<a href="https://developer.android.com/ndk/index.html" target="_blank" rel="noopener">Android SDK</a>，<a href="https://developers.google.com/android/guides/overview" target="_blank" rel="noopener">Google Play服务</a>和<a href="https://cloud.google.com/" target="_blank" rel="noopener">Google云平台</a>等。</p>
<h3 id="Android-Things架构"><a href="#Android-Things架构" class="headerlink" title="Android Things架构"></a>Android Things架构</h3><p>先看Brillo和Android Things的架构图对比：</p>
<p>这是<strong>Brillo</strong>：<br><img src="http://oartlnou9.bkt.clouddn.com/android-things/images/brillo-architecture.png" alt=""><br>这是<strong>Android Things</strong>：<br><img src="http://oartlnou9.bkt.clouddn.com/android-things/images/androidthings-architecture.png" alt=""></p>
<p><strong>可以很清楚的看出来</strong>：</p>
<ul>
<li>Brillo是一个非常精剪的Androd运行时环境，没有ART，可以看成只运行Linux内核和部分Android本地库的Android系统，可以运行的硬件最低配置为32M内存和128M存储，使用C/C++基于NDK进行开发，开发和部署明显不同于<a href="https://www.android.com" target="_blank" rel="noopener">核心Android</a>。Android Things与<a href="https://www.android.com" target="_blank" rel="noopener">核心Android</a>框架大致相同，支持<a href="https://developers.google.com/android/" target="_blank" rel="noopener">Google APIs for Android</a>的一个子集，并通过引入<a href="https://developer.android.com/things/sdk/index.html#things_support_library" target="_blank" rel="noopener">Things Support Library</a>提供了额外的API，这些API支持创建用户驱动程序，允许应用集成原先没有的新硬件。</li>
<li><a href="https://developer.android.com/studio/index.html" target="_blank" rel="noopener">Android Studio</a>，<a href="https://developers.google.com/android/guides/overview" target="_blank" rel="noopener">Google Play服务</a>，<a href="https://firebase.google.com/" target="_blank" rel="noopener">Firebase</a>，<a href="https://developers.google.com/weave/" target="_blank" rel="noopener">Weave</a>和活跃的开发者社区形成了完整的开发生态。如果你喜欢，你甚至可以在<a href="https://developer.android.com/studio/index.html" target="_blank" rel="noopener">Android Studio</a>中使用C/C++进行开发。</li>
<li>利用Android系统的<a href="https://source.android.com/devices/tech/ota/index.html" target="_blank" rel="noopener">OTA更新</a>机制，设备能够及时收到Google官方安全更新、bug fixes等，开发人员能够集中精力于构建产品本身。</li>
<li>不管是Brillo还是Android Things均运行于Linux之上，而Linux是一个使用<a href="https://en.wikipedia.org/wiki/Virtual_memory" target="_blank" rel="noopener">虚拟内存</a>技术的操作系统。这意味着Android Things所运行的处理器必须支持虚拟内存，换句话说，Android Things所运行的处理器是一个拥有完<a href="https://en.wikipedia.org/wiki/Memory_management_unit" target="_blank" rel="noopener">MMU</a>的处理器。</li>
</ul>
<h3 id="Android-Things协议"><a href="#Android-Things协议" class="headerlink" title="Android Things协议"></a>Android Things协议</h3><p>Android Things默认集成<a href="https://developers.google.com/weave/" target="_blank" rel="noopener">Weave</a>协议。<a href="https://developers.google.com/weave/" target="_blank" rel="noopener">Weave</a>是一个物联网通讯协议，不仅支持设备与设备连接，还支持手机与设备连接，手机、设备连接至Google服务的强大能力。同时，<a href="https://developers.google.com/weave/" target="_blank" rel="noopener">Weave</a>也不依赖于任何通信协议，它可以运行在Wi-Fi，BLE，Zigbee等常见的通信协议之上。<img src="http://oartlnou9.bkt.clouddn.com/android-things/images/weave.jpg" alt=""><br>由于<a href="https://developers.google.com/weave/" target="_blank" rel="noopener">Weave</a>被设计为一个平台无关的通信协议，针对不同的目标设备，包括资源受限的嵌入式设备，Weave通过引入不同的实现方式来应对。这些不同目标设备上的代码或组件，共同组合了Weave。</p>
<p>Weave提供了一套标准的设备操作命令（叫做Schema），以及对应的认证机制。Weave对常见的物联网设备，当前主要是智能家居设备，进行了总结和抽象，并形成了一套固定的操作命令集合，内部叫做Schema，并以<a href="https://en.wikipedia.org/wiki/JSON" target="_blank" rel="noopener">JSON格式</a>进行描述。Weave这样做的目标，是希望达到不同设备厂商的设备之间，只要使用了Weave，就可以相互操作的目的。同时Weave还引入了一套认证机制，不在标准schema框架内的设备及操作，可以经过Google的认证后，添加到标准schema中。这样就确保了整个schema框架的可扩展性，长此以往，就可以形成一个完整和丰富的生态链。</p>
<h3 id="Android-Things硬件"><a href="#Android-Things硬件" class="headerlink" title="Android Things硬件"></a>Android Things硬件</h3><p>Android Things与SoC厂商合作，通过提供包含SoMs（System-on-Modules）的认证开发板使得开发者即使不了解嵌入式系统设计也能够快速开发完整的产品。SoMs将SoC，内存，Flash存储，WiFi，蓝牙等整合在一块开发板上。一站式硬件解决方案、Google管理BSP支持以及基于Android SDK、Android Studio的软件开发平台，极大的降低了开发门槛及成本。</p>
<p>Android Things现在官方支持的开发板包括<a href="https://developer.android.com/things/hardware/edison.html" target="_blank" rel="noopener">Intel Edison</a>，<a href="https://developer.android.com/things/hardware/joule.html" target="_blank" rel="noopener">Intel Joule</a>（Android Things Developer Preview 2新增），<a href="https://developer.android.com/things/hardware/pico.html" target="_blank" rel="noopener">NXP Pico i.MX6UL</a>，<a href="https://developer.android.com/things/hardware/raspberrypi.html" target="_blank" rel="noopener">Raspberry Pi 3</a>，厂商可以通过<a href="https://developer.android.com/things/hardware/partner-toolkit.html#messaging_guidelines" target="_blank" rel="noopener">Partner ToolKit</a>来申请Android Things的官方认证。</p>
<h3 id="Android-Things-SDK"><a href="#Android-Things-SDK" class="headerlink" title="Android Things SDK"></a>Android Things SDK</h3><p>Android Things通过<a href="https://developer.android.com/things/sdk/index.html#things_support_library" target="_blank" rel="noopener">Things Support Library</a>提供额外的APIs扩展了核心Android的功能，这些APIs允许应用程序整合新的硬件类型。同时，Android Things平台被设计为单应用模式的线性结构，应用程序开机自动启动，没有其他系统应用。</p>
<h4 id="Things-Support-Library"><a href="#Things-Support-Library" class="headerlink" title="Things Support Library"></a>Things Support Library</h4><p><a href="https://developer.android.com/things/sdk/index.html#things_support_library" target="_blank" rel="noopener">Things Support Library</a>主要包括外设I/O API和用户驱动API。外设I/O API使得应用能够使用业界标准的协议和接口（当前包括GPIO，PWM，I2C，SPI，UART）与传感器、电动机等通信。用户驱动API允许应用程序注入硬件事件到系统框架，以便其他应用程序能够通过标准APIs感知这些硬件事件。</p>
<h4 id="相比核心Android行为变更"><a href="#相比核心Android行为变更" class="headerlink" title="相比核心Android行为变更"></a>相比核心Android行为变更</h4><ul>
<li>Android Things不包含标准的系统应用和内容提供者套件，所以开发Android Things应用应避免使用<a href="https://developer.android.com/guide/components/intents-common.html" target="_blank" rel="noopener">common intents</a>，以及内容提供者，包括<a href="https://developer.android.com/reference/android/provider/CalendarContract.html" target="_blank" rel="noopener">CalendarContract</a>，<a href="https://developer.android.com/reference/android/provider/ContactsContract.html" target="_blank" rel="noopener">ContactsContract</a>，<a href="https://developer.android.com/reference/android/provider/DocumentsContract.html" target="_blank" rel="noopener">DocumentsContract</a>，<a href="https://developer.android.com/reference/android/app/DownloadManager.html" target="_blank" rel="noopener">DownloadManager</a>，<a href="https://developer.android.com/reference/android/provider/MediaStore.html" target="_blank" rel="noopener">MediaStore</a>，<br><a href="https://developer.android.com/reference/android/provider/Settings.html" target="_blank" rel="noopener">Settings</a>，<a href="https://developer.android.com/reference/android/provider/Telephony.html" target="_blank" rel="noopener">Telephony</a>，<a href="https://developer.android.com/reference/android/provider/UserDictionary.html" target="_blank" rel="noopener">UserDictionary</a>，<a href="https://developer.android.com/reference/android/provider/VoicemailContract.html" target="_blank" rel="noopener">VoicemailContract</a>。</li>
<li>Android Things不强制要求显示屏，且即使在图形模式下，Android Things并不包含系统状态栏和底部导航栏。</li>
<li>Android Things要求应用程序在menifest文件中导出”home activiy“作为系统主入口，以便设备启动时能够自动启动。<a href="https://developer.android.com/reference/android/app/Activity.html" target="_blank" rel="noopener">Activity</a>可以通过添加一个包含<code>CATEGORY_DEFAULT</code>和<code>IOT_LAUNCHER</code>的<a href="https://developer.android.com/reference/android/content/IntentFilter.html" target="_blank" rel="noopener">intent filter</a>即可实现。</li>
<li>Android Things支持部分Google Service APIs，通常，那些需要用户输入和证书认证的APIs是不可用的。同时，Android Things不支持<a href="https://developer.android.com/distribute/googleplay/index.html" target="_blank" rel="noopener">Google Play Store</a>，所以设备中的Play Services版本是静态的、不会自动更新的。</li>
<li>Android Things不支持动态权限，因为嵌入式设备不确定是否有显示屏来接受运行时对话框。应用程序在manifest文件中声明的所有权限都会在应用程序安装时全部授权。</li>
<li>Android Things因为没有系统状态栏，所有也不支持系统通知。</li>
</ul>
<h3 id="Android-Things开发"><a href="#Android-Things开发" class="headerlink" title="Android Things开发"></a>Android Things开发</h3><p>Android Things应用程序与核心Android应用程序有相同的结构，所以你可以通过修改现有应用程序或基于现有应用程序创建新的应用来开发Android Things应用程序。同时，你还需要一块运行<a href="https://developer.android.com/things/hardware/developer-kits.html" target="_blank" rel="noopener">Android Things的开发板</a>。</p>
<h4 id="先决条件"><a href="#先决条件" class="headerlink" title="先决条件"></a>先决条件</h4><ul>
<li>SDK工具版本24及以上。</li>
<li>平台版本Android 7.0（API 24）及以上。</li>
<li>设置应用程序的targetSdkVersion设置为Android 7.0（API 24）及以上。</li>
</ul>
<h4 id="添加Things-Support-Library依赖库"><a href="#添加Things-Support-Library依赖库" class="headerlink" title="添加Things Support Library依赖库"></a>添加Things Support Library依赖库</h4><p>1.在应用级别的build.gradle添加依赖：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    ...</span><br><span class="line">    provided &apos;com.google.android.things:androidthings:0.2-devpreview&apos;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p><code>provided</code>依赖配置表明应用程序在设备上运行时应使用设备上已存在的共享库。</p>
</blockquote>
<p>2.在manifest文件中声明使用共享库：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;application ...&gt;</span><br><span class="line">    &lt;uses-library android:name=&quot;com.google.android.things&quot;/&gt;</span><br><span class="line">    ...</span><br><span class="line">&lt;/application&gt;</span><br></pre></td></tr></table></figure></p>
<h4 id="声明Home-Activity"><a href="#声明Home-Activity" class="headerlink" title="声明Home Activity"></a>声明Home Activity</h4><p>Android Things上运行的应用程序必须在manifest文件里声明一个activity作为系统启动后的主入口。声明一个包含如下属性的<a href="https://developer.android.com/reference/android/content/IntentFilter.html" target="_blank" rel="noopener">intent filter</a>：</p>
<ul>
<li><strong>Action</strong>：<a href="https://developer.android.com/reference/android/content/Intent.html#ACTION_MAIN" target="_blank" rel="noopener">ACTION_MAIN</a></li>
<li><strong>Category</strong>：<a href="https://developer.android.com/reference/android/content/Intent.html#CATEGORY_DEFAULT" target="_blank" rel="noopener">CATEGORY_DEFAULT</a></li>
<li><strong>Category</strong>：<code>IOT_LAUNCHER</code></li>
</ul>
<p>为了方便开发，同一个Activity应包含一个<a href="https://developer.android.com/reference/android/content/Intent.html#CATEGORY_LAUNCHER" target="_blank" rel="noopener">CATEGORY_LAUNCHER</a> intent filter，以便Android Studio能默认启动它。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;application</span><br><span class="line">    android:label=&quot;@string/app_name&quot;&gt;</span><br><span class="line">    &lt;uses-library android:name=&quot;com.google.android.things&quot;/&gt;</span><br><span class="line">    &lt;activity android:name=&quot;.HomeActivity&quot;&gt;</span><br><span class="line">        &lt;!-- Launch activity as default from Android Studio --&gt;</span><br><span class="line">        &lt;intent-filter&gt;</span><br><span class="line">            &lt;action android:name=&quot;android.intent.action.MAIN&quot;/&gt;</span><br><span class="line">            &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot;/&gt;</span><br><span class="line">        &lt;/intent-filter&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- Launch activity automatically on boot --&gt;</span><br><span class="line">        &lt;intent-filter&gt;</span><br><span class="line">            &lt;action android:name=&quot;android.intent.action.MAIN&quot;/&gt;</span><br><span class="line">            &lt;category android:name=&quot;android.intent.category.IOT_LAUNCHER&quot;/&gt;</span><br><span class="line">            &lt;category android:name=&quot;android.intent.category.DEFAULT&quot;/&gt;</span><br><span class="line">        &lt;/intent-filter&gt;</span><br><span class="line">    &lt;/activity&gt;</span><br><span class="line">&lt;/application&gt;</span><br></pre></td></tr></table></figure></p>
<p>更多开发内容，请参考<a href="https://developer.android.com/things/sdk/samples.html" target="_blank" rel="noopener">Samples</a>和<a href="https://github.com/androidthings" target="_blank" rel="noopener">GitHub</a>。</p>
<hr>
<p>参考</p>
<ul>
<li><a href="https://developer.android.com/things/index.html" target="_blank" rel="noopener">https://developer.android.com/things/index.html</a></li>
<li><a href="https://www.leiphone.com/news/201612/bTY6FmG2EncrijnD.html" target="_blank" rel="noopener">https://www.leiphone.com/news/201612/bTY6FmG2EncrijnD.html</a></li>
<li><a href="https://www.diycode.cc/topics/518" target="_blank" rel="noopener">https://www.diycode.cc/topics/518</a></li>
<li><a href="https://blog.csdn.net/hellochina15/article/details/51969995" target="_blank" rel="noopener">https://blog.csdn.net/hellochina15/article/details/51969995</a></li>
</ul>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/开发/">开发</a>
    </span>
    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/Android/">Android</a><a href="/tags/Things/">Things</a><a href="/tags/IoT/">IoT</a><a href="/tags/Brillo/">Brillo</a>
    </span>
    

    </div>

    
  </div>
</article>

  



    </main>

    <footer class="site-footer">
  <p class="site-info">
    </br>
    
    &copy; 2018 Feilong Wang
    
    </br>
    The content of this site is licensed under
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a>.
  </p>
</footer>

    


<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?45dd316ffe62b50cd95a1fd9a37e8b11";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


  </div>
</div>
</body>
</html>
